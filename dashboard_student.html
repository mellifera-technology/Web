<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <title>Panel Estudiante ‚Äî MIELLIFERA</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="icon" href="assets/logo.svg" />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.3/dist/chart.umd.min.js"></script>
  <style>
    :root{
      --bg:#0e0f12;--bg-soft:#13151a;--card:#171a21;--card-2:#1b1f27;
      --text:#eef0f3;--muted:#b8bec7;--border:#262b35;--zebra:#141820;
      --accent:#ffd54f;--accent-600:#f0c12c;--focus:#7fb3ff;
      --blue-ln:rgba(77,163,255,.45);--blue-pt:#4da3ff;
      --amber-ln:rgba(255,183,77,.55);--amber-pt:#ff7043;
      --ok:#49d17d;--warn:#ffb74d;--bad:#ff6b6b;--idle:#9aa3ad;
      --chip-bg:#10141a;
    }
    html,body{height:100%}
    body{margin:0;background:var(--bg);color:var(--text);font-family:Inter,system-ui,Arial;font-size:16.5px;line-height:1.6}
    .site{padding:24px;max-width:1200px;margin:0 auto}
    .header{position:sticky;top:0;background:rgba(14,15,18,.9);backdrop-filter:blur(6px);z-index:10;border-bottom:1px solid var(--border)}
    .nav-grid{display:grid;grid-template-columns:1fr auto auto;gap:16px;align-items:center;padding:12px 16px}
    .brand{color:var(--accent);text-decoration:none;font-weight:800}
    .nav-center a{color:#d6dae0;text-decoration:none;margin:0 10px}
    .cta{background:var(--accent);color:#111;border:0;padding:9px 14px;border-radius:10px;font-weight:700;cursor:pointer}

    .section{margin:28px auto}
    .section.alt{background:var(--bg-soft);border:1px solid var(--border);border-radius:14px;padding:16px}
    .section-head{display:flex;justify-content:space-between;align-items:center;gap:12px;margin-bottom:12px}
    .split{display:grid;grid-template-columns:420px 1fr;gap:18px}
    @media(max-width:980px){.split{grid-template-columns:1fr}}

    .card{background:var(--card);border:1px solid var(--border);border-radius:12px;padding:16px}
    .side-cards{display:grid;grid-template-columns:1fr 1fr;gap:16px}
    @media(max-width:860px){.side-cards{grid-template-columns:1fr}}

    .pill{background:var(--accent);color:#111;border:2px solid var(--accent);border-radius:999px;font-weight:800;padding:8px 14px;white-space:nowrap}
    .btn{background:var(--card-2);color:var(--text);border:1px solid var(--border);padding:10px 16px;border-radius:10px;font-weight:600;cursor:pointer}
    .btn.yellow{background:var(--accent);border-color:var(--accent);color:#111}
    .btn.small{padding:6px 10px;font-size:.9rem}
    .center{display:flex;justify-content:center;align-items:center}
    .muted{color:var(--muted)}

    .cards-head{display:flex;justify-content:flex-end;align-items:center;margin:12px 0 6px}
    .cards-grid{display:grid;grid-template-columns:repeat(2,1fr);gap:16px}
    @media(max-width:860px){.cards-grid{grid-template-columns:1fr}}

    table{border-collapse:separate;border-spacing:0;width:100%;background:var(--card);border:1px solid var(--border);border-radius:12px;overflow:hidden}
    thead th{position:sticky;top:0;background:var(--accent);color:#111;font-weight:800;padding:10px;border-bottom:2px solid #caa332}
    tbody td{padding:10px;border-bottom:1px solid var(--border)}
    tbody tr:nth-child(odd){background:var(--zebra)}
    #tableWrap{box-shadow:0 1px 0 rgba(0,0,0,.2) inset}

    .reveal-wrap{display:flex;align-items:center;gap:8px;flex-wrap:wrap}
    .eye-btn{background:#1d212a;border:1px solid var(--border);color:#cfd6df;border-radius:8px;cursor:pointer;padding:4px 8px;display:inline-flex;align-items:center;gap:6px}
    .eye-btn svg{width:18px;height:18px}

    /* Overlay */
    #deviceOverlay{position:fixed;inset:0;display:none;z-index:1000;background:rgba(8,10,14,.95);backdrop-filter:blur(4px)}
    #devicePanel{position:absolute;inset:0;display:grid;grid-template-rows:auto 1fr;max-width:1200px;margin:0 auto}
    .overlay-header{display:flex;align-items:center;gap:12px;padding:12px 16px;border-bottom:1px solid var(--border);background:#0f1218}
    .overlay-content{padding:16px;overflow:auto}
    .overlay-grid{display:grid;grid-template-columns:1fr 1fr 320px;gap:16px;margin-bottom:12px}
    @media(max-width:1100px){.overlay-grid{grid-template-columns:1fr 1fr}}
    @media(max-width:760px){.overlay-grid{grid-template-columns:1fr}}

    .metric{display:flex;align-items:baseline;gap:10px;margin-top:6px}
    .metric .val{font-size:2.4rem;font-weight:800;letter-spacing:.3px}
    .metric .unit{font-size:1.05rem;font-weight:800;color:#111;background:var(--accent);border-radius:8px;padding:2px 8px;border:2px solid var(--accent)}

    #chartsWrap{display:none;margin-top:14px}
    .chart-card{background:var(--card);border:1px solid var(--border);border-radius:12px;padding:12px}
    .charts-grid{display:grid;grid-template-columns:1fr 1fr;gap:16px}
    @media(max-width:860px){.charts-grid{grid-template-columns:1fr}}
    .chart-box{position:relative;height:240px}
    .chart-box canvas{position:absolute;inset:0;width:100% !important;height:100% !important}
    .hist-controls{display:none;gap:10px;align-items:end;margin-top:10px;flex-wrap:wrap}
    .hist-actions{display:flex;gap:8px}

    .date-chip{display:flex;align-items:center;gap:0;background:var(--chip-bg);border:1px solid var(--border);border-radius:10px}
    .date-chip input[type="date"]{appearance:none;-webkit-appearance:none;border:0;background:transparent;color:#fff;padding:8px 10px;cursor:pointer}
    .date-chip input[type="date"]::-webkit-calendar-picker-indicator{display:none}
    .cal-btn{background:var(--accent);border:2px solid var(--accent);color:#111;border-radius:0 10px 10px 0;padding:8px 10px;display:inline-flex;align-items:center;cursor:pointer}
    .cal-btn svg{width:18px;height:18px;color:#111}
    .cal-btn:focus{outline:2px solid var(--focus)}

    .nice-table{border:1px solid var(--border);border-radius:12px;overflow:hidden;background:var(--card)}
    .nice-table thead th{background:var(--accent);color:#111;border-bottom:1px solid #caa332}
    .nice-table tbody tr:nth-child(odd){background:var(--zebra)}
    .nice-table td,.nice-table th{padding:10px}
    .badge{display:inline-block;background:#222;border:1px solid var(--border);padding:2px 8px;border-radius:999px;font-weight:700}

    .status-row{display:flex;align-items:center;gap:8px;color:var(--muted);margin:.25rem 0 0}
    .status-dot{width:10px;height:10px;border-radius:50%;background:var(--idle);box-shadow:0 0 0 2px rgba(0,0,0,.2) inset}

    .wx-card{background:linear-gradient(140deg,#0b0d12,#141926);border:1px solid var(--border);border-radius:12px;padding:14px;margin-top:12px;position:relative;overflow:hidden}
    .wx-blur{filter:blur(3px);opacity:.6;pointer-events:none}
    .wx-head{display:flex;justify-content:space-between;align-items:center;margin-bottom:8px;gap:8px;flex-wrap:wrap}
    .wx-title{font-weight:800}
    .wx-tiles{display:grid;grid-template-columns:repeat(3,1fr);gap:8px}
    .wx-tile{background:#10141a;border:1px solid var(--border);border-radius:10px;padding:8px;text-align:center}
    .wx-big{font-size:1.6rem;font-weight:800}
    .wx-small{color:var(--muted);font-size:.9rem}
    .wx-loc{color:var(--muted);font-size:.9rem}
    .wx-today{display:flex;justify-content:space-between;align-items:center;background:#10141a;border:1px solid var(--border);border-radius:10px;padding:10px;margin-bottom:8px}
    .loc-chip{display:flex;gap:8px;align-items:center;background:var(--chip-bg);border:1px solid var(--border);border-radius:10px;padding:6px 6px}
    .loc-chip input{background:transparent;border:0;color:#fff;padding:6px;font-weight:600;min-width:220px}
  </style>
</head>
<body>
  <header class="header">
    <div class="nav-grid">
      <a class="brand" href="#">MIELLIFERA</a>
      <nav class="nav-center" aria-label="Principal"></nav>
      <button id="btnLogout" class="cta">Salir</button>
    </div>
  </header>

  <main class="site">
    <div style="background:var(--accent);color:#111;text-align:center;padding:8px;font-weight:700;margin-bottom:16px">
      üü° MODO DEMOSTRACI√ìN ‚Äî Sin conexi√≥n real
    </div>

    <section class="section alt">
      <div class="section-head">
        <div>
          <h2>Tu panel (Demo)</h2>
          <p class="muted">Datos simulados para mostrar interfaz.</p>
        </div>
        <div style="display:flex;gap:8px;align-items:center;flex-wrap:wrap">
          <button id="lastReading" class="pill">√öltima medici√≥n: 15/10/2025 14:30</button>
          <button id="btnProdMain" class="btn small">Producci√≥n</button>
        </div>
      </div>

      <div class="split">
        <!-- Cuenta -->
        <div class="card" style="max-width:420px">
          <h3>Cuenta</h3>
          <p class="reveal-wrap">
            <span>Email: <b id="uEmail">xxxx@xxxx.com</b></span>
            <button id="toggleEmail" class="eye-btn">
              <span>Mostrar</span>
            </button>
          </p>
          <p class="reveal-wrap">
            <span>C√≥digo de 4 d√≠gitos: <b id="uCode">XXXX</b></span>
            <button id="toggleCode" class="eye-btn">
              <span>Mostrar</span>
            </button>
          </p>
          <div class="reveal-wrap" style="margin-top:6px">
            <button id="btnTutorials" class="btn small">Tutoriales</button>
          </div>
          <div id="msg" class="muted" style="margin-top:8px"></div>
          <hr style="border:0;border-top:1px solid var(--border)">

          <div>
            <h3 style="margin:10px 0 8px">Clima y pron√≥stico</h3>
            <div id="wxCard" class="wx-card">
              <div class="wx-head">
                <div class="wx-title">Buenos Aires, Argentina</div>
              </div>
              <div id="wxContent">
                <div class="wx-today">
                  <div>
                    <div class="wx-big" id="wxNow">22 ¬∞C</div>
                    <div class="wx-loc">Buenos Aires, AR</div>
                    <div class="wx-small">Nublado ¬∑ HR 58 %</div>
                  </div>
                  <div class="wx-small">M√°x 24¬∞ ¬∑ M√≠n 18¬∞ ¬∑ üíß 1mm</div>
                </div>
                <div class="wx-tiles" id="wxTiles">
                  <div class="wx-tile">
                    <div class="wx-small">Jue</div>
                    <div>üå§Ô∏è</div>
                    <div class="wx-small">Parcial</div>
                    <div class="wx-small">24¬∞ / 19¬∞</div>
                    <div class="wx-small">üíß 0mm</div>
                  </div>
                  <div class="wx-tile">
                    <div class="wx-small">Vie</div>
                    <div>‚òÄÔ∏è</div>
                    <div class="wx-small">Despejado</div>
                    <div class="wx-small">25¬∞ / 20¬∞</div>
                    <div class="wx-small">üíß 0mm</div>
                  </div>
                  <div class="wx-tile">
                    <div class="wx-small">S√°b</div>
                    <div>‚òÅÔ∏è</div>
                    <div class="wx-small">Nublado</div>
                    <div class="wx-small">23¬∞ / 18¬∞</div>
                    <div class="wx-small">üíß 2mm</div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- KPIs madre + gr√°ficos -->
        <div>
          <div class="side-cards">
            <div class="card">
              <h3>Temperatura Exterior</h3>
              <div class="metric"><span id="temVal" class="val">23.4</span><span class="unit">¬∞C</span></div>
              <div id="temWhen" class="muted">15/10/2025 14:25</div>
            </div>
            <div class="card">
              <h3>Humedad Exterior</h3>
              <div class="metric"><span id="humVal" class="val">56</span><span class="unit">%</span></div>
              <div id="humWhen" class="muted">15/10/2025 14:25</div>
            </div>
          </div>

          <div class="center" style="margin-top:14px">
            <button id="btnChart" class="btn yellow">Mostrar gr√°fica</button>
          </div>

          <div id="chartsWrap">
            <div class="charts-grid">
              <div class="chart-card">
                <h3 id="titleTemp">Temperatura de hoy</h3>
                <div class="chart-box"><canvas id="chartTemp"></canvas></div>
              </div>
              <div class="chart-card">
                <h3 id="titleHum">Humedad de hoy</h3>
                <div class="chart-box"><canvas id="chartHum"></canvas></div>
              </div>
            </div>
          </div>

          <div class="cards-head">
            <button id="btnEdit" class="btn small">Editar orden</button>
          </div>
          <div id="autoCards" class="cards-grid"></div>
        </div>
      </div>
    </section>

    <section class="section" id="lecturas">
      <div class="section-head">
        <h3>Historial de mediciones</h3>
        <button id="toggleTbl" class="btn">Mostrar / Ocultar historial</button>
      </div>
      <div id="tableWrap" style="overflow:auto;max-height:60vh;display:none;border-radius:12px">
        <table id="tbl">
          <thead><tr><th>Fecha</th><th>Dispositivo</th><th>Sensor</th><th>Valor / Info</th></tr></thead>
          <tbody></tbody>
        </table>
      </div>
    </section>
  </main>

<script>
const $ = id => document.getElementById(id);

// Datos simulados generales
const now = new Date();
function fmtDate(d){ return d.toLocaleString('es-AR'); }
const madreTemps = [21,22,23,24,23,22,21].map((v,i)=>({x:i,y:v + Math.random()}));
const madreHums = [50,52,55,60,58,55,53].map((v,i)=>({x:i,y:v + Math.random()*2}));

const colmenas = [
  {id: 101, temps: [30,31,32,33,32,31,30], hums: [60,61,59,62,60,59,61], prodToday: 3.1},
  {id: 203, temps: [29,30,31,32,31,30,29], hums: [55,56,54,57,55,54,56], prodToday: 2.9},
  {id: 317, temps: [33,34,35,36,35,34,33], hums: [58,59,60,61,60,59,60], prodToday: 3.5},
  {id: 404, temps: [28,29,30,31,30,29,28], hums: [62,63,61,64,62,61,63], prodToday: 2.7}
];

// Poner tarjetas de colmenas simuladas
function renderColmenas(){
  const wrap = $('autoCards');
  wrap.innerHTML = colmenas.map(c=>{
    return `<div class="card device-card" style="cursor:pointer" data-id="${c.id}">
      <h3>Colmena ${c.id}</h3>
      <div class="metric"><span class="val">${(c.temps.slice(-1)[0]).toFixed(1)}</span><span class="unit">¬∞C</span></div>
      <div class="metric"><span class="val">${(c.hums.slice(-1)[0]).toFixed(1)}</span><span class="unit">%</span></div>
      <div class="metric"><span class="val">${c.prodToday.toFixed(2)}</span><span class="unit">kg</span></div>
      <div class="muted">√öltima lectura: ${fmtDate(now)}</div>
    </div>`;
  }).join('');
}

// Overlay manejo
function openOverlay(id){
  const ov = $('deviceOverlay');
  ov.style.display = 'block';
  const c = colmenas.find(c=>c.id == id);
  if(!c) return;
  $('overlayTitle').textContent = `Colmena ${c.id}`;
  $('ovTemVal').textContent = c.temps.slice(-1)[0].toFixed(1);
  $('ovHumVal').textContent = c.hums.slice(-1)[0].toFixed(1);
  $('ovProd').textContent = c.prodToday.toFixed(2);
  $('ovTemWhen').textContent = fmtDate(now);
  $('ovHumWhen').textContent = fmtDate(now);
  // gr√°fica
  renderOverlayChart(c);
}
function closeOverlay(){
  $('deviceOverlay').style.display = 'none';
}
document.addEventListener('click', e=>{
  const c = e.target.closest('.device-card');
  if(c) openOverlay(c.dataset.id);
});
$('btnOverlayBack').onclick = closeOverlay;

// Gr√°ficas madre
let chartT=null, chartH=null;
$('btnChart').onclick = ()=>{
  const wrap = $('chartsWrap');
  wrap.style.display = wrap.style.display === 'none' ? 'block' : 'none';
  if(wrap.style.display === 'block'){
    renderMotherCharts();
  }
};

function renderMotherCharts(){
  const ctxT = $('chartTemp').getContext('2d');
  const labels = madreTemps.map(d=>`${d.x}:00`);
  const valsT = madreTemps.map(d=>d.y);
  const valsH = madreHums.map(d=>d.y);
  if(chartT) chartT.destroy();
  if(chartH) chartH.destroy();
  chartT = new Chart(ctxT, {
    type:'line',
    data:{labels, datasets:[{data: valsT, borderColor: 'var(--amber-ln)', backgroundColor: 'var(--amber-pt)', tension: .25}]},
    options:{plugins:{legend:{display:false}}}
  });
  const ctxH = $('chartHum').getContext('2d');
  chartH = new Chart(ctxH, {
    type:'line',
    data:{labels, datasets:[{data: valsH, borderColor: 'var(--blue-ln)', backgroundColor: 'var(--blue-pt)', tension: .25}]},
    options:{plugins:{legend:{display:false}}}
  });
}

// Overlay chart por colmena
let ovChart=null;
function renderOverlayChart(c){
  const ctx = $('ovChartTemp').getContext('2d');
  const labels = c.temps.map((v,i)=>`${i+8}:00`);
  const vals = c.temps;
  if(ovChart) ovChart.destroy();
  ovChart = new Chart(ctx, {
    type:'line',
    data:{labels, datasets:[{data: vals, borderColor: 'var(--amber-ln)', backgroundColor: 'var(--amber-pt)', tension: .25}]},
    options:{plugins:{legend:{display:false}}}
  });
}

// Tabla simulada de lecturas
function renderTable(){
  const tb = document.querySelector('#tbl tbody');
  const rows = [];
  colmenas.forEach(c=>{
    c.temps.forEach((v,i)=>{
      rows.push(`<tr><td>${fmtDate(now)}</td><td>${c.id}</td><td>TEM</td><td>${v.toFixed(1)}</td></tr>`);
    });
    c.hums.forEach((v,i)=>{
      rows.push(`<tr><td>${fmtDate(now)}</td><td>${c.id}</td><td>HUM</td><td>${v.toFixed(1)}</td></tr>`);
    });
  });
  tb.innerHTML = rows.join('');
}

// Init
(function(){
  renderColmenas();
  renderTable();
})();

$('toggleTbl').onclick = ()=> {
  const w = $('tableWrap');
  w.style.display = w.style.display === 'none' ? 'block' : 'none';
};
$('btnLogout').onclick = ()=> window.location.href = 'login.html';
</script>
</body>
</html>
